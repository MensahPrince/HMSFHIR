{% extends "Patients/main.html" %}
{% load static %}
{% block PageName %}Pulled Records{% endblock PageName %}

{% block content %}
<h1>Inspect Pulled Patient Data</h1>
{% if error %}
    <p>{{ error }}</p>
{% else %}
    <form method="get" action="{% url 'pull_patient_condition' patient_id=patient_id %}">
        {% csrf_token %}
        <label for="patient_id">Enter Patient ID:</label>
        <input type="text" id="patient_id" name="patient_id" required>
        <button type="submit">Pull Patient Data</button>
    </form>
    {% if patient_id %}
        <p>Patient ID: {{ patient_id }}</p>
        <p>Identifier: {{ identifier }}</p>
        <p>First Name: {{ first_name }}</p>
        <p>Last Name: {{ last_name }}</p>
        <p>Birth Date: {{ birth_date }}</p>
        <p>Gender: {{ gender }}</p>
        <p>Address: {{ address }}</p>
        <p>Phone Number: {{ phone_number }}</p>
        
        <h2>Condition Details</h2>
        {% if condition_details %}
            <p>ID: {{ condition_details.id }}</p>
            <p>Clinical Status: {{ condition_details.clinical_status }}</p>
            <p>Verification Status: {{ condition_details.verification_status }}</p>
            <p>Category: {{ condition_details.category }}</p>
            <p>Severity: {{ condition_details.severity }}</p>
            <p>Code: {{ condition_details.code }}</p>
            <p>Subject: {{ condition_details.subject }}</p>
            <p>Encounter: {{ condition_details.encounter }}</p>
            <p>Onset: {{ condition_details.onset }}</p>
            <p>Abatement: {{ condition_details.abatement }}</p>
            <p>Recorded Date: {{ condition_details.recorded_date }}</p>
            <p>Recorder: {{ condition_details.recorder }}</p>
            <p>Asserter: {{ condition_details.asserter }}</p>
            <p>Stage: {{ condition_details.stage }}</p>
            <p>Evidence: {{ condition_details.evidence }}</p>
            <p>Note: {{ condition_details.note }}</p>
            <input type="hidden" name="condition_details" value="{{ condition_details|safe }}">
        {% else %}
            <p>No condition details available</p>
        {% endif %}
        
        <button type="submit">Save Patient Data</button>
    {% endif %}
{% endif %}
{% endblock %}